<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="

Actual ET, or actual evapotranspiration, is a measure of the amount of water that is lost from the land surface through evaporation and transpiration by plants.
Under the concept of the conceptual HM, the actual ET is always calculated by the potential ET \(E_p\), which evaluates the meteorological and landuse (vegetation) situations.
The second point to consider is the water availability of the land or soil.
So we can give the function from:
\[E_a = f_{evatransActual}(D_{atms}, D_{lssg})\]
to:
\[E_a = f_{evatransActual}(E_p, W_{lssg}, ...) = k^* E_p\]
where
\(E_a\) is land_evatrans_mm or soil_evatrans_mm
\(E_p\) is atmos_potentialEvatrans_mm
\(k^*\) is estimated ratio.


Then the different evatransActual methods will estimate the ratio \(k^*\).
The output density distribution from 7 methods:
"><title>actuall evapotranspiration — evatransActual • EDCHM</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/Open_Sans-0.4.5/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="actuall evapotranspiration — evatransActual"><meta property="og:description" content="

Actual ET, or actual evapotranspiration, is a measure of the amount of water that is lost from the land surface through evaporation and transpiration by plants.
Under the concept of the conceptual HM, the actual ET is always calculated by the potential ET \(E_p\), which evaluates the meteorological and landuse (vegetation) situations.
The second point to consider is the water availability of the land or soil.
So we can give the function from:
\[E_a = f_{evatransActual}(D_{atms}, D_{lssg})\]
to:
\[E_a = f_{evatransActual}(E_p, W_{lssg}, ...) = k^* E_p\]
where
\(E_a\) is land_evatrans_mm or soil_evatrans_mm
\(E_p\) is atmos_potentialEvatrans_mm
\(k^*\) is estimated ratio.


Then the different evatransActual methods will estimate the ratio \(k^*\).
The output density distribution from 7 methods:
"><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">EDCHM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.9</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/EDCHM.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/LuckyKanLei/EDCHM/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1><strong>actuall evapotranspiration</strong></h1>
      <small class="dont-index">Source: <a href="https://github.com/LuckyKanLei/EDCHM/blob/HEAD/R/RcppExports.R" class="external-link"><code>R/RcppExports.R</code></a></small>
      <div class="d-none name"><code>evatransActual.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>

Actual ET, or actual evapotranspiration, is a measure of the amount of water that is lost from the land surface through evaporation and transpiration by plants.</p>
<p>Under the concept of the conceptual HM, the actual ET is always calculated by the potential ET <em></em>\(E_p\), which evaluates the meteorological and landuse (vegetation) situations.
The second point to consider is the water availability of the land or soil.</p>
<p>So we can give the function from:</p>
<p>\[E_a = f_{evatransActual}(D_{atms}, D_{lssg})\]</p>
<p>to:</p>
<p>\[E_a = f_{evatransActual}(E_p, W_{lssg}, ...) = k^* E_p\]</p>
<p>where</p><ul><li><p><em></em>\(E_a\) is <code>land_evatrans_mm</code> or <code>soil_evatrans_mm</code></p></li>
<li><p><em></em>\(E_p\) is <code>atmos_potentialEvatrans_mm</code></p></li>
<li><p><em></em>\(k^*\) is estimated ratio.</p></li>
</ul><p>Then the different <code>evatransActual</code> methods will estimate the ratio <em></em>\(k^*\).</p>
<p>The output density distribution from 7 methods:</p>
<p><img src="figures/mdl_evatransActual.svg" alt=""></p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">evatransActual_SupplyRatio</span><span class="op">(</span></span>
<span>  <span class="va">atmos_potentialEvatrans_mm</span>,</span>
<span>  <span class="va">water_mm</span>,</span>
<span>  <span class="va">capacity_mm</span>,</span>
<span>  <span class="va">param_evatrans_sur_k</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">evatransActual_SupplyPow</span><span class="op">(</span></span>
<span>  <span class="va">atmos_potentialEvatrans_mm</span>,</span>
<span>  <span class="va">water_mm</span>,</span>
<span>  <span class="va">capacity_mm</span>,</span>
<span>  <span class="va">param_evatrans_sup_k</span>,</span>
<span>  <span class="va">param_evatrans_sup_gamma</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">evatransActual_VIC</span><span class="op">(</span></span>
<span>  <span class="va">atmos_potentialEvatrans_mm</span>,</span>
<span>  <span class="va">water_mm</span>,</span>
<span>  <span class="va">capacity_mm</span>,</span>
<span>  <span class="va">param_evatrans_vic_gamma</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">evatransActual_GR4J</span><span class="op">(</span><span class="va">atmos_potentialEvatrans_mm</span>, <span class="va">water_mm</span>, <span class="va">capacity_mm</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">evatransActual_UBC</span><span class="op">(</span></span>
<span>  <span class="va">atmos_potentialEvatrans_mm</span>,</span>
<span>  <span class="va">water_mm</span>,</span>
<span>  <span class="va">capacity_mm</span>,</span>
<span>  <span class="va">param_evatrans_ubc_gamma</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">evatransActual_LiangLand</span><span class="op">(</span></span>
<span>  <span class="va">atmos_potentialEvatrans_mm</span>,</span>
<span>  <span class="va">water_mm</span>,</span>
<span>  <span class="va">capacity_mm</span>,</span>
<span>  <span class="va">param_evatrans_lia_gamma</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">evatransActual_LiangSoil</span><span class="op">(</span></span>
<span>  <span class="va">atmos_potentialEvatrans_mm</span>,</span>
<span>  <span class="va">water_mm</span>,</span>
<span>  <span class="va">capacity_mm</span>,</span>
<span>  <span class="va">param_evatrans_lia_B</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>atmos_potentialEvatrans_mm</dt>
<dd><p>(mm/m2/TS) <strong>potential / reference</strong> evapotranspiration</p></dd>


<dt>water_mm</dt>
<dd><p>(mm/m2/TS) water volume in <code>soilLy</code>, <code>groundLy</code> or intercept of <code>landLy</code>, same as <code>soil_water_mm</code>, <code>ground_water_mm</code> or <code>land_interceptWater_mm</code></p></dd>


<dt>capacity_mm</dt>
<dd><p>(mm/m2) water storage capacity in <code>soilLy</code>, <code>groundLy</code> or intercept of <code>landLy</code>, same as <code>soil_capacity_mm</code>, <code>ground_capacity_mm</code> or<code>land_interceptCapacity_mm</code></p></dd>


<dt>param_evatrans_sur_k</dt>
<dd><p>&lt;0.1, 1&gt; parameter for <code>evatransActual_SupplyRatio()</code>, ratio of potential ET, that is estimated as actually ET</p></dd>


<dt>param_evatrans_sup_k</dt>
<dd><p>&lt;0.1, 1&gt; parameter for <code>evatransActual_SupplyPow()</code>, ratio of this method</p></dd>


<dt>param_evatrans_sup_gamma</dt>
<dd><p>&lt;1, 5&gt; parameter for <code>evatransActual_SupplyPow()</code>, exponent of this method</p></dd>


<dt>param_evatrans_vic_gamma</dt>
<dd><p>&lt;0.2, 5&gt; parameter for <code>evatransActual_VIC()</code></p></dd>


<dt>param_evatrans_ubc_gamma</dt>
<dd><p>&lt;0.5, 2&gt; parameter for <code>evatransActual_UBC()</code></p></dd>


<dt>param_evatrans_lia_gamma</dt>
<dd><p>&lt;0.4, 1&gt; parameter for <code>evatransActual_LiangLand()</code></p></dd>


<dt>param_evatrans_lia_B</dt>
<dd><p>&lt;0.01, 3&gt; parameter for <code>evatransActual_LiangSoil()</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>actually ET in (mm/m2/TS)</p><ul><li><p>evaporation in interception (landLy), <code>land_evatrans_mm</code></p></li>
<li><p>transpiration in root</p></li>
<li><p>evaporation in soil (soilLy), <code>soil_evatrans_mm</code></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="-supplyratio-"><strong>_SupplyRatio</strong>:<a class="anchor" aria-label="anchor" href="#-supplyratio-"></a></h2>
    <p><img src="figures/mdl_evatransActual_sur.svg" alt=""></p>
<p>The water content (the ratio to the maximal capacity)
is considered as th main factors for the ratio <em></em>\(k^*\).
\[k^* = k  \frac{W}{C}\]
where</p><ul><li><p><em></em>\(W\) is water volume in (mm/m2/TS), <code>water_mm</code>, <code>land_interceptWater_mm</code>, <code>soil_water_mm</code></p></li>
<li><p><em></em>\(C\) is water capacity in (mm/m2), <code>capacity_mm</code>, <code>land_interceptCapacity_mm</code>, <code>soil_capacity_mm</code></p></li>
<li><p><em></em>\(k\) is <code>param_evatrans_sur_k</code></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="-supplypow-"><strong>_SupplyPow</strong>:<a class="anchor" aria-label="anchor" href="#-supplypow-"></a></h2>
    <p><img src="figures/mdl_evatransActual_sup.svg" alt=""></p>
<p>The water content (the ratio to the maximal capacity)
is considered as th main factors for the ratio <em></em>\(k^*\).
\[k^* = k  \left(\frac{W}{C}\right)^\gamma\]
where</p><ul><li><p><em></em>\(k\) is <code>param_evatrans_sup_k</code></p></li>
<li><p><em></em>\(\gamma\) is <code>param_evatrans_sup_gamma</code></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="-vic-wood-et-al-"><strong>_VIC</strong> (Wood et al. 1992)
:<a class="anchor" aria-label="anchor" href="#-vic-wood-et-al-"></a></h2>
    <p><img src="figures/mdl_evatransActual_vic.svg" alt=""></p>
<p>This method is similar with <code>evatransActual_SupplyPow()</code>, estimate the water content in the storage.
\[k^* = 1-\left(1-\frac{W}{C}\right)^{\gamma}\]
where</p><ul><li><p><em></em>\(\gamma\) is <code>param_evatrans_vic_gamma</code></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="-gr-j-perrin-et-al-"><strong>_GR4J</strong> (Perrin et al. 2003)
:<a class="anchor" aria-label="anchor" href="#-gr-j-perrin-et-al-"></a></h2>
    <p><img src="figures/mdl_evatransActual_gr4.svg" alt=""></p>
<p>It is a little different than other method, it estimate not the ratio <em></em>\(f\),
rather dieectly a equation with potential ET and water content.
And it need <strong>no parameter</strong>.
\[E_a = \frac{W\left(2-\frac{W}{C}\right)\tanh \left(\frac{E_p}{C}\right)}{1 + \left(1-\frac{W}{C}\right)\tanh \left(\frac{E_p}{C}\right)}\]</p>
    </div>
    <div class="section level2">
    <h2 id="-ubc-quick-and-pipes-"><strong>_UBC</strong> (Quick and Pipes 1977)
:<a class="anchor" aria-label="anchor" href="#-ubc-quick-and-pipes-"></a></h2>
    <p><img src="figures/mdl_evatransActual_ubc.svg" alt=""></p>
<p>It estimates the water content in the storage.
(This is a little different than original, the parameter <code>P0AGEN</code> is replaced by <em></em>\(\frac{C}{\gamma}\).)
\[k^* = 10^{\gamma \frac{W-C}{C}}\]
where</p><ul><li><p><em></em>\(\gamma\) is <code>param_evatrans_ubc_gamma</code></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="-liangland-liang-et-al-"><strong>_LiangLand</strong> (Liang et al. 1994)
:<a class="anchor" aria-label="anchor" href="#-liangland-liang-et-al-"></a></h2>
    <p><img src="figures/mdl_evatransActual_lia.svg" alt=""></p>
<p>It is also a similar method like <code>evatransActual_SupplyPow()</code>,
but it will estimate the supply ability agian, whwn the water is still not enough.
\[E_a^* = \left(\frac{W}{C}\right)^\gamma E_p\]
\[E_a = \min \left(1, \frac{W}{E_a^*}\right) E_a^*\]
where</p><ul><li><p><em></em>\(E_l^*\) is the first estimated actuall ET</p></li>
<li><p><em></em>\(E_l\) is actuall ET from land, <code>land_evatrans_mm</code></p></li>
<li><p><em></em>\(\gamma\) is <code>param_evatrans_lia_gamma</code></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="-liangsoil-liang-et-al-"><strong>_LiangSoil</strong> (Liang et al. 1994)
:<a class="anchor" aria-label="anchor" href="#-liangsoil-liang-et-al-"></a></h2>
    <p><img src="figures/mdl_evatransActual_sia.svg" alt=""></p>
<p>It estimates the water content in the storage.
(This is a little different than original, the parameter <code>P0AGEN</code> is replaced by <em></em>\(\frac{C}{\gamma}\).)
\[k^* = \int_{0}^{A_{s}} {\rm d} A + \int_{A_{s}}^{1} \frac{i_{0}}{i_{m} [1-(1-A)^{1 / B} ]} {\rm d} A \]
where</p><ul><li><p><em></em>\(B\) is <code>param_evatrans_lia_B</code></p></li>
<li><p><em></em>\(A\) is fraction of area</p></li>
</ul><p><img src="figures/liang_evatransSoil.png" alt=""></p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Liang X, Lettenmaier D, Wood E, Burges S (1994).
“A Simple Hydrologically Based Model of Land Surface Water and Energy Fluxes for GSMs.”
<em>J. Geophys. Res.</em>, <b>99</b>.
doi: <a href="https://doi.org/10.1029/94JD00483" class="external-link">10.1029/94JD00483</a>
.<br><br> Perrin C, Michel C, Andr攼㸹assian V (2003).
“Improvement of a Parsimonious Model for Streamflow Simulation.”
<em>Journal of Hydrology</em>, <b>279</b>(1-4), 275--289.
ISSN 00221694, doi: <a href="https://doi.org/10.1016/S0022-1694(03)00225-7" class="external-link">10.1016/S0022-1694(03)00225-7</a>
.<br><br> Quick MC, Pipes A (1977).
“U.B.C. WATERSHED MODEL / Le Mod攼㸸le Du Bassin Versant U.C.B.”
<em>Hydrological Sciences Bulletin</em>, <b>22</b>(1), 153--161.
ISSN 0303-6936, doi: <a href="https://doi.org/10.1080/02626667709491701" class="external-link">10.1080/02626667709491701</a>
.<br><br> Wood EF, Lettenmaier DP, Zartarian VG (1992).
“A Land-Surface Hydrology Parameterization with Subgrid Variability for General Circulation Models.”
<em>Journal of Geophysical Research</em>, <b>97</b>(D3), 2717.
ISSN 0148-0227.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Kan Lei.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

